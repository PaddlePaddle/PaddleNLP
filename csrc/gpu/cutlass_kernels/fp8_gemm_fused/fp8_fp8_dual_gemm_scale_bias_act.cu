// Copyright (c) 2024 PaddlePaddle Authors. All Rights Reserved.
// 
// Licensed under the Apache License, Version 2.0 (the "License");
// you may not use this file except in compliance with the License.
// You may obtain a copy of the License at
// 
//     http://www.apache.org/licenses/LICENSE-2.0
// 
// Unless required by applicable law or agreed to in writing, software
// distributed under the License is distributed on an "AS IS" BASIS,
// WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
// See the License for the specific language governing permissions and
// limitations under the License.

// Generated by generate_code_gemm_fused_kernels.py - Do not edit.

#include <map>
#include "fp8_fp8_dual_gemm_scale_bias_act.h"

COMMON_DECLARE_string(use_cutlass_device_best_config_path);

std::map<std::string, int> dual_gemm_type_map{
    {"float8_e4m3fn_float8_e4m3fn_float16_false_swiglu",   0}, 
    {"float8_e4m3fn_float8_e4m3fn_float16_true_swiglu",   1}, 
    {"float8_e4m3fn_float8_e4m3fn_float16_false_geglu",   2}, 
    {"float8_e4m3fn_float8_e4m3fn_float16_true_geglu",   3}, 
    {"float8_e4m3fn_float8_e4m3fn_bfloat16_false_swiglu",   4}, 
    {"float8_e4m3fn_float8_e4m3fn_bfloat16_true_swiglu",   5}, 
    {"float8_e4m3fn_float8_e4m3fn_bfloat16_false_geglu",   6}, 
    {"float8_e4m3fn_float8_e4m3fn_bfloat16_true_geglu",   7}, 
    {"float8_e5m2_float8_e5m2_float16_false_swiglu",   8}, 
    {"float8_e5m2_float8_e5m2_float16_true_swiglu",   9}, 
    {"float8_e5m2_float8_e5m2_float16_false_geglu",   10}, 
    {"float8_e5m2_float8_e5m2_float16_true_geglu",   11}, 
    {"float8_e5m2_float8_e5m2_bfloat16_false_swiglu",   12}, 
    {"float8_e5m2_float8_e5m2_bfloat16_true_swiglu",   13}, 
    {"float8_e5m2_float8_e5m2_bfloat16_false_geglu",   14}, 
    {"float8_e5m2_float8_e5m2_bfloat16_true_geglu",   15}, 
};

std::map<std::string, int> dual_gemm_config_map{
    {"<64, 64, 64>, <32, 32, 64>, <16, 8, 32>, 3", 0},
    {"<64, 64, 64>, <32, 32, 64>, <16, 8, 32>, 4", 1},
    {"<64, 64, 64>, <32, 32, 64>, <16, 8, 32>, 5", 2},
    {"<64, 64, 64>, <32, 32, 64>, <16, 8, 32>, 6", 3},
    {"<64, 64, 64>, <32, 32, 64>, <16, 8, 32>, 7", 4},
    {"<64, 64, 64>, <32, 32, 64>, <16, 8, 32>, 8", 5},
    {"<16, 32, 64>, <16, 32, 64>, <16, 8, 32>, 3", 6},
    {"<16, 32, 64>, <16, 32, 64>, <16, 8, 32>, 4", 7},
    {"<16, 32, 64>, <16, 32, 64>, <16, 8, 32>, 5", 8},
    {"<16, 32, 64>, <16, 32, 64>, <16, 8, 32>, 6", 9},
    {"<16, 32, 64>, <16, 32, 64>, <16, 8, 32>, 7", 10},
    {"<16, 32, 64>, <16, 32, 64>, <16, 8, 32>, 8", 11},
    {"<16, 64, 64>, <16, 32, 64>, <16, 8, 32>, 3", 12},
    {"<16, 64, 64>, <16, 32, 64>, <16, 8, 32>, 4", 13},
    {"<16, 64, 64>, <16, 32, 64>, <16, 8, 32>, 5", 14},
    {"<16, 64, 64>, <16, 32, 64>, <16, 8, 32>, 6", 15},
    {"<16, 64, 64>, <16, 32, 64>, <16, 8, 32>, 7", 16},
    {"<16, 64, 64>, <16, 32, 64>, <16, 8, 32>, 8", 17},
    {"<32, 128, 64>, <32, 32, 64>, <16, 8, 32>, 3", 18},
    {"<32, 128, 64>, <32, 32, 64>, <16, 8, 32>, 4", 19},
    {"<32, 128, 64>, <32, 32, 64>, <16, 8, 32>, 5", 20},
    {"<32, 128, 64>, <32, 32, 64>, <16, 8, 32>, 6", 21},
    {"<32, 128, 64>, <32, 32, 64>, <16, 8, 32>, 7", 22},
    {"<32, 128, 64>, <32, 32, 64>, <16, 8, 32>, 8", 23},
    {"<64, 128, 64>, <32, 64, 64>, <16, 8, 32>, 3", 24},
    {"<64, 128, 64>, <32, 64, 64>, <16, 8, 32>, 4", 25},
    {"<64, 128, 64>, <32, 64, 64>, <16, 8, 32>, 5", 26},
    {"<64, 128, 64>, <32, 64, 64>, <16, 8, 32>, 6", 27},
    {"<64, 128, 64>, <32, 64, 64>, <16, 8, 32>, 7", 28},
    {"<64, 128, 64>, <32, 64, 64>, <16, 8, 32>, 8", 29},
    {"<64, 64, 128>, <32, 64, 64>, <16, 8, 32>, 3", 30},
    {"<64, 64, 128>, <32, 64, 64>, <16, 8, 32>, 4", 31},
    {"<64, 64, 128>, <32, 64, 64>, <16, 8, 32>, 5", 32},
    {"<64, 64, 128>, <32, 64, 64>, <16, 8, 32>, 6", 33},
    {"<64, 64, 128>, <32, 64, 64>, <16, 8, 32>, 7", 34},
    {"<64, 64, 128>, <32, 64, 64>, <16, 8, 32>, 8", 35},
    {"<64, 128, 64>, <64, 32, 64>, <16, 8, 32>, 3", 36},
    {"<64, 128, 64>, <64, 32, 64>, <16, 8, 32>, 4", 37},
    {"<64, 128, 64>, <64, 32, 64>, <16, 8, 32>, 5", 38},
    {"<64, 128, 64>, <64, 32, 64>, <16, 8, 32>, 6", 39},
    {"<64, 128, 64>, <64, 32, 64>, <16, 8, 32>, 7", 40},
    {"<64, 128, 64>, <64, 32, 64>, <16, 8, 32>, 8", 41},
    {"<128, 64, 64>, <64, 32, 64>, <16, 8, 32>, 3", 42},
    {"<128, 64, 64>, <64, 32, 64>, <16, 8, 32>, 4", 43},
    {"<128, 64, 64>, <64, 32, 64>, <16, 8, 32>, 5", 44},
    {"<128, 64, 64>, <64, 32, 64>, <16, 8, 32>, 6", 45},
    {"<128, 64, 64>, <64, 32, 64>, <16, 8, 32>, 7", 46},
    {"<128, 64, 64>, <64, 32, 64>, <16, 8, 32>, 8", 47},
    {"<128, 128, 64>, <64, 32, 64>, <16, 8, 32>, 3", 48},
    {"<128, 128, 64>, <64, 32, 64>, <16, 8, 32>, 4", 49},
    {"<128, 128, 64>, <64, 32, 64>, <16, 8, 32>, 5", 50},
    {"<128, 128, 64>, <64, 32, 64>, <16, 8, 32>, 6", 51},
    {"<128, 128, 64>, <64, 32, 64>, <16, 8, 32>, 7", 52},
    {"<128, 128, 64>, <64, 32, 64>, <16, 8, 32>, 8", 53},
    {"<128, 128, 64>, <64, 64, 64>, <16, 8, 32>, 3", 54},
    {"<128, 128, 64>, <64, 64, 64>, <16, 8, 32>, 4", 55},
    {"<128, 128, 64>, <64, 64, 64>, <16, 8, 32>, 5", 56},
    {"<128, 128, 64>, <64, 64, 64>, <16, 8, 32>, 6", 57},
    {"<128, 128, 64>, <64, 64, 64>, <16, 8, 32>, 7", 58},
    {"<128, 128, 64>, <64, 64, 64>, <16, 8, 32>, 8", 59},
    {"<128, 128, 64>, <128, 32, 64>, <16, 8, 32>, 3", 60},
    {"<128, 128, 64>, <128, 32, 64>, <16, 8, 32>, 4", 61},
    {"<128, 128, 64>, <128, 32, 64>, <16, 8, 32>, 5", 62},
    {"<128, 128, 64>, <128, 32, 64>, <16, 8, 32>, 6", 63},
    {"<128, 128, 64>, <128, 32, 64>, <16, 8, 32>, 7", 64},
    {"<128, 128, 64>, <128, 32, 64>, <16, 8, 32>, 8", 65},
    {"<128, 256, 64>, <64, 64, 64>, <16, 8, 32>, 3", 66},
    {"<128, 256, 64>, <64, 64, 64>, <16, 8, 32>, 4", 67},
    {"<128, 256, 64>, <64, 64, 64>, <16, 8, 32>, 5", 68},
    {"<128, 256, 64>, <64, 64, 64>, <16, 8, 32>, 6", 69},
    {"<128, 256, 64>, <64, 64, 64>, <16, 8, 32>, 7", 70},
    {"<128, 256, 64>, <64, 64, 64>, <16, 8, 32>, 8", 71},
    {"<256, 128, 64>, <64, 64, 64>, <16, 8, 32>, 3", 72},
    {"<256, 128, 64>, <64, 64, 64>, <16, 8, 32>, 4", 73},
    {"<256, 128, 64>, <64, 64, 64>, <16, 8, 32>, 5", 74},
    {"<256, 128, 64>, <64, 64, 64>, <16, 8, 32>, 6", 75},
    {"<256, 128, 64>, <64, 64, 64>, <16, 8, 32>, 7", 76},
    {"<256, 128, 64>, <64, 64, 64>, <16, 8, 32>, 8", 77},
    {"<16, 256, 128>, <16, 64, 128>, <16, 8, 32>, 3", 78},
    {"<16, 256, 128>, <16, 64, 128>, <16, 8, 32>, 4", 79},
    {"<16, 256, 128>, <16, 64, 128>, <16, 8, 32>, 5", 80},
    {"<16, 256, 128>, <16, 64, 128>, <16, 8, 32>, 6", 81},
    {"<16, 256, 128>, <16, 64, 128>, <16, 8, 32>, 7", 82},
    {"<16, 256, 128>, <16, 64, 128>, <16, 8, 32>, 8", 83},
};

bool launch_gemm_kernel(const int type_id, const int split_k, const int kernel_id, DualGemmEpilogueAllParams params){
  switch (type_id) {
    case 0:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 1:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 2:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 3:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 4:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 5:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 6:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 7:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e4m3fn, phi::dtype::float8_e4m3fn, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 8:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 9:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 10:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 11:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::float16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 12:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 13:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_swiglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 14:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, false, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, false, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, false, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, false, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, false, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, false, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    case 15:
      if(split_k < 2){
        params.split_k = 1;
        switch (kernel_id) {
          case 0:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 1:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 2:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 3:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 4:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 5:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 6:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 7:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 8:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 9:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 10:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 11:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 32, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 12:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 13:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 14:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 15:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 16:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 17:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 64, 64>, cutlass::gemm::GemmShape<16, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 18:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 19:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 20:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 21:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 22:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 23:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<32, 128, 64>, cutlass::gemm::GemmShape<32, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 24:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 25:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 26:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 27:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 28:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 29:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 30:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 31:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 32:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 33:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 34:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 35:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 64, 128>, cutlass::gemm::GemmShape<32, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 36:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 37:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 38:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 39:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 40:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 41:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<64, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 42:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 43:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 44:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 45:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 46:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 47:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 64, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 48:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 49:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 50:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 51:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 52:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 53:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 54:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 55:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 56:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 57:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 58:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 59:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 60:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 61:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 62:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 63:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 64:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 65:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 128, 64>, cutlass::gemm::GemmShape<128, 32, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 66:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 67:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 68:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 69:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 70:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 71:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<128, 256, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 72:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 73:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 74:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 75:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 76:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 77:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<256, 128, 64>, cutlass::gemm::GemmShape<64, 64, 64>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          case 78:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 3, true, cutlass::arch::Sm89>(params);
            break;
          case 79:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 4, true, cutlass::arch::Sm89>(params);
            break;
          case 80:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 5, true, cutlass::arch::Sm89>(params);
            break;
          case 81:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 6, true, cutlass::arch::Sm89>(params);
            break;
          case 82:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 7, true, cutlass::arch::Sm89>(params);
            break;
          case 83:
            return dispatch_dual_gemm_geglu<phi::dtype::float8_e5m2, phi::dtype::float8_e5m2, phi::dtype::bfloat16,
                                  cutlass::gemm::GemmShape<16, 256, 128>, cutlass::gemm::GemmShape<16, 64, 128>,
                                  cutlass::gemm::GemmShape<16, 8, 32>, 8, true, cutlass::arch::Sm89>(params);
            break;
          default:
            throw std::runtime_error("cutlass gemm config is invalid.");
            break;
        }
      }
      else{
        throw std::runtime_error("cutlass dual gemm split_k mode is not generated.");
      }
      break;
    default:
      throw std::runtime_error("fp8_fp8_bf16_gemm_fused Config is invalid.");
      break;
  }
  return false;
}


bool fp8_fp8_dual_gemm_scale_bias_act(DualGemmEpilogueAllParams params) {
  if (dual_gemm_type_map.find(params.fuse_gemm_config) == dual_gemm_type_map.end()) {
    throw std::runtime_error("fp8 gemm_fused config is invalid.");
  }

  int type_id = dual_gemm_type_map[params.fuse_gemm_config];
  int M = (params.M+31)/32 *32;
  int N = params.N;
  int K = params.K;

  std::string mnk_string = "dual_gemm<"+ std::to_string(M)+ ", " +std::to_string(N) + ", "+ std::to_string(K)+ ">";
  std::string mnk_split_k_string =  "dual_gemm<"+ std::to_string(M)+ ", " +std::to_string(N) + ", "+ std::to_string(K)+ ">" + ", split_k";
  int split_k;
  int kernel_id;
  std::string best_config;
  CutlassGemmConfigMannager& best_config_mannager = CutlassGemmConfigMannager::getInstance();
  if(getenv("FLAGS_use_cutlass_device_best_config_path")){ // run kernel
    std::string config_file_path = getenv("FLAGS_use_cutlass_device_best_config_path");
    nlohmann::json* config_json = best_config_mannager.get_gemm_best_configs(config_file_path);
    if (config_json->contains(mnk_string)) {
        best_config = config_json->at(mnk_string);
    } else {
        std::cerr << "Can not find the config for this gemm shape, please tune this shape: " << mnk_string <<std::endl;
    }

    if (config_json->contains(mnk_split_k_string)) {
        split_k = config_json->at(mnk_split_k_string);
    } else {
        std::cerr << "Can not find the config(split_k) for this gemm shape, please tune this shape: " << mnk_string <<std::endl;
    }

    if (dual_gemm_config_map.find(best_config) == dual_gemm_config_map.end()) {
        throw std::runtime_error("This config'kernel not be generate, please check generate_code_gemm_fused_kernels.py and re-generate.");
    } else {
        kernel_id = dual_gemm_config_map[best_config];
    }
    return launch_gemm_kernel(type_id, split_k, kernel_id, params);
  } else { // tune kernel
    int warm_up_times = 5;
    int tune_times = 10;
    std::string best_kernel_id = "";
    int best_split_k = -1;
    float duratation = 1000000.f;
    // tune all split_k, kernel_id kernels
    for(int i = 1; i < 1+1; ++i){ // all split_k
        for(const auto& config_pair : dual_gemm_config_map){
            bool is_valid = true;
            // warm up
            for(int num_time = 0; num_time < warm_up_times; ++num_time){
                if(!launch_gemm_kernel(type_id, i, config_pair.second, params)){
                    is_valid = false;
                    break;
                }
            }
            if(!is_valid){
                continue;
            }
            cudaEvent_t start, stop;
            cudaEventCreate(&start);
            cudaEventCreate(&stop);
            cudaStreamSynchronize(params.stream);
            cudaEventRecord(start, params.stream);
            for(int num_time = 0; num_time < tune_times; ++num_time){
                if(!launch_gemm_kernel(type_id, i, config_pair.second, params)){
                    is_valid = false;
                    break;
                };
            }
            cudaEventRecord(stop, params.stream);
            cudaEventSynchronize(stop);
            float elapsedTime;
            if(is_valid){
                cudaEventElapsedTime(&elapsedTime, start, stop);
            } else {
                continue;
            }
            cudaEventDestroy(start);
            cudaEventDestroy(stop);
            if(elapsedTime < duratation){
              best_kernel_id = config_pair.first;
              best_split_k = i;
              duratation = elapsedTime;
            }
        }
    }

    nlohmann::json new_json;
    new_json[mnk_string] = best_kernel_id;
    new_json[mnk_split_k_string] = best_split_k;
    best_config_mannager.up_date_configs(new_json);
    std::cout <<"Gemm tune result for " << mnk_string<< ": best config is: "<< best_kernel_id << ", split k: " << best_split_k << std::endl;
    return true;
  }
}
